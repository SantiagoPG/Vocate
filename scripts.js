const translations = {
  es: {
    welcome: "Bienvenido a Vocate",
    description: `"Cultivada en la tierra, disfrutada en el alma"<br>
      Vocate nace en el coraz√≥n de Antioquia, fusionando tradici√≥n y creatividad para ofrecer una experiencia cervecera √∫nica.
      Esta bendita y refrescante cerveza artesanal destaca por su equilibrio perfecto entre cuerpo y sabor, con vibrantes notas c√≠tricas que despiertan los sentidos.
      Con un 5% de alcohol, es ideal para quienes buscan disfrutar de una bebida ligera, pero con car√°cter.
      Su proceso de elaboraci√≥n cuidadoso y el uso de ingredientes seleccionados garantizan una textura suave y un final limpio,
      convirti√©ndola en una opci√≥n inolvidable para los amantes de la buena cerveza.`,
    price: "Precio: $13.000",
    carta: "Carta",
    llamar: "Llamar",
    comoLlegar: "C√≥mo llegar",
    cartaDigital: "Carta digital generada por",
    restaurante: "Vocate",
    direccion: "Cl. 11 #12-42, Santa F√© de Antioquia, Antioquia",
    pedir: "Pedir",
    confirmarPedido: "Confirmar pedido",
    menu: "Men√∫",
    nombre: "Nombre",
    mesa: "N√∫mero de mesa",
    comentario: "Comentario (opcional)",
    enviarPedido: "Enviar pedido",
    cancelar: "Cancelar",
    confirmarPedidoTitulo: "¬øConfirmas tu pedido?",
    productos: {
      cerveza: {
        nombre: "Cerveza Vocate",
        descripcion: "Esta bendita y refrescante cerveza artesanal destaca por su equilibrio perfecto entre cuerpo y sabor, con vibrantes notas c√≠tricas que despiertan los sentidos. Con un 5% de alcohol, es ideal para quienes buscan disfrutar de una bebida ligera, pero con car√°cter."
      },
      mango: {
        nombre: "Mango Biche",
        descripcion: "Tiritas de mango verde fresco servidas en copa, acompa√±adas de una rodaja de lim√≥n para resaltar su sabor √°cido y refrescante. üå± Perfecto para abrir el apetito o disfrutar con una cerveza artesanal bien fr√≠a."
      },
      nachos: {
        nombre: "Nachos",
        descripcion: "Nachos de ma√≠z ba√±ados en cremosa salsa de queso cheddar derretido, coronados con rodajas de jalape√±os en conserva para un toque picante irresistible. üßÄüî• Perfectos para compartir."
      },
      mani: {
        nombre: "Mani Salado",
        descripcion: "Cl√°sico man√≠ crocante, ligeramente salado y perfecto para picar. Ideal como acompa√±amiento informal para disfrutar junto a una cerveza bien fr√≠a. üßÇ Sencillo, sabroso y siempre bienvenido."
      },
      aguacate: {
        nombre: "Aguacate relleno con ceviche de camar√≥n",
        descripcion: "Mitad de aguacate fresco relleno con una mezcla vibrante de camarones cocidos, tomate, cebolla morada, piment√≥n y cilantro, todo ba√±ado en un toque de jugo de lim√≥n. üåä Una explosi√≥n tropical de frescura, suavidad y textura."
      }
    }
  },
  en: {
    welcome: "Welcome to Vocate",
    description: `"Grown in the earth, enjoyed in the soul"<br>
      Vocate is born in the heart of Antioquia, blending tradition and creativity to offer a unique craft beer experience.
      This blessed and refreshing beer stands out for its perfect balance between body and flavor, with vibrant citrus notes that awaken the senses.
      With 5% alcohol, it's ideal for those seeking a light yet characterful drink.
      Its careful brewing process and selected ingredients ensure a smooth texture and clean finish,
      making it an unforgettable choice for true beer lovers.`,
    price: "Price: $13,000",
    carta: "Menu",
    llamar: "Call",
    comoLlegar: "Get Directions",
    cartaDigital: "Digital menu generated by",
    restaurante: "Vocate",
    direccion: "Cl. 11 #12-42, Santa F√© de Antioquia, Antioquia",
    pedir: "Order",
    confirmarPedido: "Confirm order",
    menu: "Menu",
    nombre: "Name",
    mesa: "Table number",
    comentario: "Comment (optional)",
    enviarPedido: "Send order",
    cancelar: "Cancel",
    confirmarPedidoTitulo: "Confirm your order?",
    productos: {
      cerveza: {
        nombre: "Vocate Beer",
        descripcion: "This blessed and refreshing craft beer stands out for its perfect balance between body and flavor, with vibrant citrus notes that awaken the senses. With 5% alcohol, it's ideal for those seeking a light yet characterful drink."
      },
      mango: {
        nombre: "Green Mango",
        descripcion: "Fresh green mango strips served in a cup, accompanied by a lemon slice to enhance its acidic and refreshing taste. üå± Perfect as an appetizer or to enjoy with a cold craft beer."
      },
      nachos: {
        nombre: "Nachos",
        descripcion: "Corn nachos covered in creamy melted cheddar cheese sauce, topped with preserved jalape√±o slices for an irresistible spicy touch. üßÄüî• Perfect for sharing."
      },
      mani: {
        nombre: "Salted Peanuts",
        descripcion: "Classic crunchy peanuts, lightly salted and perfect for snacking. Ideal as an informal accompaniment to enjoy with a cold beer. üßÇ Simple, tasty, and always welcome."
      },
      aguacate: {
        nombre: "Avocado stuffed with shrimp ceviche",
        descripcion: "Fresh avocado half filled with a vibrant mix of cooked shrimp, tomato, purple onion, bell pepper, and cilantro, all bathed in a touch of lemon juice. üåä A tropical explosion of freshness, smoothness, and texture."
      }
    }
  },
  de: {
    welcome: "Willkommen bei Vocate",
    description: `"In der Erde gewachsen, in der Seele genossen"<br>
      Vocate entsteht im Herzen von Antioquia und verbindet Tradition und Kreativit√§t f√ºr ein einzigartiges Biererlebnis.
      Dieses gesegnete und erfrischende Bier zeichnet sich durch seine perfekte Balance zwischen K√∂rper und Geschmack aus, mit lebendigen Zitrusnoten, die die Sinne wecken.
      Mit 5% Alkohol ist es ideal f√ºr diejenigen, die ein leichtes, aber charaktervolles Getr√§nk suchen.
      Sein sorgf√§ltiger Brauprozess und ausgew√§hlte Zutaten garantieren eine weiche Textur und einen sauberen Abgang,
      was es zu einer unvergesslichen Wahl f√ºr echte Bierliebhaber macht.`,
    price: "Preis: $13.000",
    carta: "Karte",
    llamar: "Anrufen",
    comoLlegar: "Wegbeschreibung",
    cartaDigital: "Digitale Karte erstellt von",
    restaurante: "Vocate",
    direccion: "Cl. 11 #12-42, Santa F√© de Antioquia, Antioquia",
    pedir: "Bestellen",
    confirmarPedido: "Bestellung best√§tigen",
    menu: "Speisekarte",
    nombre: "Name",
    mesa: "Tischnummer",
    comentario: "Kommentar (optional)",
    enviarPedido: "Bestellung senden",
    cancelar: "Abbrechen",
    confirmarPedidoTitulo: "Bestellung best√§tigen?",
    productos: {
      cerveza: {
        nombre: "Vocate Bier",
        descripcion: "Dieses gesegnete und erfrischende Craft-Bier zeichnet sich durch seine perfekte Balance zwischen K√∂rper und Geschmack aus, mit lebendigen Zitrusnoten, die die Sinne wecken. Mit 5% Alkohol ist es ideal f√ºr diejenigen, die ein leichtes, aber charaktervolles Getr√§nk suchen."
      },
      mango: {
        nombre: "Gr√ºne Mango",
        descripcion: "Frische gr√ºne Mangostreifen in einer Tasse serviert, begleitet von einer Zitronenscheibe, um den s√§uerlichen und erfrischenden Geschmack zu verst√§rken. üå± Perfekt als Vorspeise oder zum Genie√üen mit einem kalten Craft-Bier."
      },
      nachos: {
        nombre: "Nachos",
        descripcion: "Maisnachos √ºberzogen mit cremiger geschmolzener Cheddar-K√§sesauce, belegt mit eingelegten Jalape√±o-Scheiben f√ºr eine unwiderstehliche w√ºrzige Note. üßÄüî• Perfekt zum Teilen."
      },
      mani: {
        nombre: "Gesalzene Erdn√ºsse",
        descripcion: "Klassische knusprige Erdn√ºsse, leicht gesalzen und perfekt zum Knabbern. Ideal als informelle Beilage zum Genie√üen mit einem kalten Bier. üßÇ Einfach, lecker und immer willkommen."
      },
      aguacate: {
        nombre: "Avocado gef√ºllt mit Garnelen-Ceviche",
        descripcion: "Frische Avocadoh√§lfte gef√ºllt mit einer lebendigen Mischung aus gekochten Garnelen, Tomaten, roten Zwiebeln, Paprika und Koriander, alles in einem Hauch von Zitronensaft gebadet. üåä Eine tropische Explosion von Frische, Weichheit und Textur."
      }
    }
  },
  fr: {
    welcome: "Bienvenue chez Vocate",
    description: `"Cultiv√©e dans la terre, savour√©e dans l'√¢me"<br>
      Vocate na√Æt au c≈ìur d'Antioquia, alliant tradition et cr√©ativit√© pour offrir une exp√©rience brassicole unique.
      Cette bi√®re b√©nie et rafra√Æchissante se distingue par son √©quilibre parfait entre corps et saveur, avec des notes vibrantes d'agrumes qui √©veillent les sens.
      Avec 5% d'alcool, elle est id√©ale pour ceux qui recherchent une boisson l√©g√®re mais avec du caract√®re.
      Son processus de brassage soign√© et l'utilisation d'ingr√©dients s√©lectionn√©s garantissent une texture douce et une finale propre,
      en faisant un choix inoubliable pour les vrais amateurs de bi√®re.`,
    price: "Prix: $13.000",
    carta: "Carte",
    llamar: "Appeler",
    comoLlegar: "Itin√©raire",
    cartaDigital: "Carte num√©rique g√©n√©r√©e par",
    restaurante: "Vocate",
    direccion: "Cl. 11 #12-42, Santa F√© de Antioquia, Antioquia",
    pedir: "Commander",
    confirmarPedido: "confirmer la commande",
    menu: "Menu",
    nombre: "Nom",
    mesa: "Num√©ro de table",
    comentario: "Commentaire (optionnel)",
    enviarPedido: "Envoyer la commande",
    cancelar: "Annuler",
    confirmarPedidoTitulo: "Confirmer votre commande ?",
    productos: {
      cerveza: {
        nombre: "Bi√®re Vocate",
        descripcion: "Cette bi√®re b√©nie et rafra√Æchissante se distingue par son √©quilibre parfait entre corps et saveur, avec des notes vibrantes d'agrumes qui √©veillent les sens. Avec 5% d'alcool, elle est id√©ale pour ceux qui recherchent une boisson l√©g√®re mais avec du caract√®re."
      },
      mango: {
        nombre: "Mangue Verte",
        descripcion: "Lani√®res de mangue verte fra√Æche servies dans une coupe, accompagn√©es d'une tranche de citron pour rehausser son go√ªt acide et rafra√Æchissant. üå± Parfait comme ap√©ritif ou √† d√©guster avec une bi√®re artisanale bien fra√Æche."
      },
      nachos: {
        nombre: "Nachos",
        descripcion: "Nachos de ma√Øs napp√©s d'une sauce cr√©meuse au fromage cheddar fondu, garnis de tranches de jalape√±os marin√©s pour une touche √©pic√©e irr√©sistible. üßÄüî• Parfait pour partager."
      },
      mani: {
        nombre: "Cacahu√®tes Sal√©es",
        descripcion: "Cacahu√®tes croustillantes classiques, l√©g√®rement sal√©es et parfaites pour grignoter. Id√©ales comme accompagnement informel √† d√©guster avec une bi√®re bien fra√Æche. üßÇ Simple, savoureux et toujours bienvenu."
      },
      aguacate: {
        nombre: "Avocat farci au ceviche de crevettes",
        descripcion: "Demi-avocat frais farci d'un m√©lange vibrant de crevettes cuites, tomates, oignons rouges, poivrons et coriandre, le tout baign√© d'une touche de jus de citron. üåä Une explosion tropicale de fra√Æcheur, de douceur et de texture."
      }
    }
  }
};

function changeLanguage(lang) {
  localStorage.setItem("language", lang);
  updateTexts();
}

function updateTexts() {
  const lang = localStorage.getItem("language") || "es";
  const cartaButton = document.querySelector('button[onclick="goToMenu()"]');
  if (cartaButton) cartaButton.textContent = translations[lang].carta;

  const llamarLink = document.querySelector('a[href^="tel:"]');
  if (llamarLink) llamarLink.textContent = `üìû ${translations[lang].llamar}`;

  const mapsLink = document.querySelector('a[href^="https://www.google.com/maps"]');
  if (mapsLink) mapsLink.textContent = `üìç ${translations[lang].comoLlegar}`;

  const infoP = document.querySelector('.info p');
  if (infoP) infoP.innerHTML = `<strong>${translations[lang].restaurante}</strong><br>${translations[lang].direccion}`;

  const footerP = document.querySelector('footer p');
  if (footerP) footerP.innerHTML = `${translations[lang].cartaDigital} <span class="marca">Rezagoter</span>`;

  // Actualizar textos en menu.html
  const menuTitle = document.querySelector('.menu-header h1');
  if (menuTitle) menuTitle.textContent = translations[lang].menu;

  // Actualizar el bot√≥n de confirmar pedido con el total
  const confirmOrderBtn = document.getElementById('confirm-order-btn');
  if (confirmOrderBtn) {
    const total = getOrderTotal();
    confirmOrderBtn.textContent = `${translations[lang].confirmarPedido} ($${total.toLocaleString()})`;
  }

  // Actualizar textos del modal
  const modalTitle = document.querySelector('.modal-content h2');
  if (modalTitle) modalTitle.textContent = translations[lang].confirmarPedidoTitulo;

  const nameLabel = document.querySelector('label[for="customer-name"]');
  if (nameLabel) nameLabel.textContent = translations[lang].nombre;

  const tableLabel = document.querySelector('label[for="table-number"]');
  if (tableLabel) tableLabel.textContent = translations[lang].mesa;

  const commentLabel = document.querySelector('label[for="order-comment"]');
  if (commentLabel) commentLabel.textContent = translations[lang].comentario;

  const sendOrderBtn = document.getElementById('send-order-btn');
  if (sendOrderBtn) sendOrderBtn.textContent = translations[lang].enviarPedido;

  const cancelBtn = document.querySelector('.modal-content button[onclick="closeModal()"]');
  if (cancelBtn) cancelBtn.textContent = translations[lang].cancelar;

  // Actualizar nombres y descripciones de productos
  const menuItems = document.querySelectorAll('.menu-item');
  menuItems.forEach(item => {
    const titleElement = item.querySelector('.menu-info h2');
    const descElement = item.querySelector('.menu-description');
    
    if (titleElement && descElement) {
      const productKey = getProductKey(titleElement.textContent.trim());
      if (productKey && translations[lang].productos[productKey]) {
        titleElement.textContent = translations[lang].productos[productKey].nombre;
        descElement.textContent = translations[lang].productos[productKey].descripcion;
      }
    }
  });
}

function getProductKey(spanishName) {
  const productMap = {
    'Cerveza Vocate': 'cerveza',
    'Mango Biche': 'mango',
    'Nachos': 'nachos',
    'Mani Salado': 'mani',
    'Aguacate relleno con ceviche de camar√≥n': 'aguacate'
  };
  return productMap[spanishName];
}

function goToMenu() {
  const currentLang = localStorage.getItem("language") || "es";
  window.location.href = `menu.html?lang=${currentLang}`;
}

function closeModal() {
  document.getElementById("order-modal").classList.add("hidden");
}

function openModal() {
  document.getElementById("order-modal").classList.remove("hidden");
}
const telegramToken = "7640380344:AAEfQgNMn68tjc1yZ7Qo-uiz2MzogKMYMS4";
const chatId = "-4861996433"


document.addEventListener("DOMContentLoaded", () => {
  // Configura eventos para botones + / -
  document.querySelectorAll('.quantity-stepper').forEach(stepper => {
    const minusBtn = stepper.querySelector('.minus');
    const plusBtn = stepper.querySelector('.plus');
    const quantitySpan = stepper.querySelector('.quantity-value');

    minusBtn.addEventListener('click', () => {
      let qty = parseInt(quantitySpan.textContent, 10);
      if (qty > 0) qty--;
      quantitySpan.textContent = qty;
      updateOrderButtonVisibility();
    });

    plusBtn.addEventListener('click', () => {
      let qty = parseInt(quantitySpan.textContent, 10);
      qty++;
      quantitySpan.textContent = qty;
      updateOrderButtonVisibility();
    });
  });

  document.querySelectorAll('.menu-description').forEach(p => {
    p.addEventListener('click', () => {
      p.classList.toggle('expanded');
    });
  });

  // Bot√≥n para confirmar pedido abre el modal
  const confirmButton = document.getElementById('confirm-order-btn');
  if (confirmButton) {
    confirmButton.addEventListener('click', openModal);
  }

  // Bot√≥n dentro del modal que realmente env√≠a el pedido
  const sendBtn = document.getElementById('send-order-btn');
  if (sendBtn) {
    sendBtn.addEventListener('click', sendOrder);
  }

  updateOrderButtonVisibility();
});

function updateOrderButtonVisibility() {
  const hasQuantity = [...document.querySelectorAll('.quantity-value')]
    .some(span => parseInt(span.textContent, 10) > 0);

  const btn = document.getElementById("confirm-order-btn");
  if (!btn) return;

  const lang = localStorage.getItem("language") || "es";
  if (hasQuantity) {
    btn.style.display = "block";
    const total = getOrderTotal();
    btn.textContent = `${translations[lang].confirmarPedido} ($${total.toLocaleString()})`;
  } else {
    btn.style.display = "none";
  }
}

function getOrderTotal() {
  let total = 0;
  document.querySelectorAll('.quantity-stepper').forEach(stepper => {
    const value = parseInt(stepper.querySelector(".quantity-value").textContent, 10);
    const price = parseInt(stepper.dataset.price, 10);
    total += value * price;
  });
  return total;
}

function sendOrder(e) {
  if (e) e.preventDefault();

  const name = document.getElementById("customer-name").value.trim();
  const table = document.getElementById("table-number").value.trim();
  const comment = document.getElementById("order-comment").value.trim() || "...";

  if (!name || !table) {
    alert("Por favor completa todos los campos.");
    return;
  }

  const products = [];
  document.querySelectorAll(".quantity-stepper").forEach(stepper => {
    const menuItem = stepper.closest('.menu-item');
    if (!menuItem) return;

    const titleElement = menuItem.querySelector(".menu-info h2");
    if (!titleElement) return;

    const title = titleElement.textContent.trim();
    const quantity = parseInt(stepper.querySelector(".quantity-value").textContent, 10);
    const price = parseInt(stepper.dataset.price, 10);

    if (quantity > 0) {
      products.push({ name: title, quantity, price });
    }
  });

  if (products.length === 0) {
    alert("Selecciona al menos un producto.");
    return;
  }

  let message = `üßæ Nuevo pedido:
üë§ Nombre: ${name}
ü™ë Mesa: ${table}
üìù Comentario: ${comment}

üì¶ Productos:

`;

  let total = 0;

  products.forEach(p => {
    const subtotal = p.quantity * p.price;
    message += `- ${p.name} x${p.quantity} = $${subtotal.toLocaleString()}\n`;
    total += subtotal;
  });

  message += `üíµ Total: $${total.toLocaleString()}`;

  fetch(`https://api.telegram.org/bot${telegramToken}/sendMessage`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      chat_id: chatId,
      text: message,
    })
  })
  .then(response => {
    if (!response.ok) throw new Error("Error al enviar a Telegram");
    alert("‚úÖ Pedido enviado correctamente.");
    document.getElementById("order-form").reset();
    document.querySelectorAll(".quantity-value").forEach(span => span.textContent = "0");
    updateOrderButtonVisibility();
    closeModal();
  })
  .catch(err => {
    console.error(err);
    alert("‚ùå Hubo un problema al enviar el pedido.");
  });
}
